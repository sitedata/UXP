<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="reftest-wait" onload="startTest()" version="1.1"><title>Testing that dynamic changes to the element for a given ID are reflected in patterns</title><rect id="u1" width="11%" height="100%" x="10%" fill="url(#r1)"/><script>// force frame construction; test that parsing &quot;r1&quot; after frame construction // is still bound to &quot;u1&quot; eventually var rect = document.getElementById(&quot;u1&quot;).getBoundingClientRect();</script><pattern id="r1" width="100%" height="100%" patternUnits="userSpaceOnUse"><rect width="100%" height="100%" fill="#0f0"/></pattern><pattern id="x" width="100%" height="100%" patternUnits="userSpaceOnUse"><rect width="100%" height="100%" fill="#0f0"/></pattern><rect id="u2" width="11%" height="100%" x="20%" fill="url(#r2)"/><pattern id="r3" width="100%" height="100%" patternUnits="userSpaceOnUse"><rect width="100%" height="100%" fill="red"/></pattern><pattern id="r3" width="100%" height="100%" patternUnits="userSpaceOnUse"><rect width="100%" height="100%" fill="#0f0"/></pattern><rect id="u3" width="11%" height="100%" x="30%" fill="url(#r3)"/><pattern id="r4" width="100%" height="100%" patternUnits="userSpaceOnUse"><rect width="100%" height="100%" fill="red"/></pattern><pattern id="r4" width="100%" height="100%" patternUnits="userSpaceOnUse"><rect width="100%" height="100%" fill="#0f0"/></pattern><rect id="u4" width="11%" height="100%" x="40%" fill="url(#r4)"/><pattern id="r5" width="100%" height="100%" patternUnits="userSpaceOnUse"><rect width="100%" height="100%" fill="red"/></pattern><rect id="u5" width="11%" height="100%" x="50%" fill="url(#r5)"/><pattern id="r6" width="100%" height="100%" patternUnits="userSpaceOnUse"><rect width="100%" height="100%" fill="red"/></pattern><pattern id="r6-2" width="100%" height="100%" patternUnits="userSpaceOnUse"><rect width="100%" height="100%" fill="#0f0"/></pattern><rect id="u6" width="11%" height="100%" x="60%" fill="url(#r6)"/><pattern id="r7" width="100%" height="100%" patternUnits="userSpaceOnUse"><rect width="100%" height="100%" fill="#0f0"/></pattern><pattern id="r7-2" width="100%" height="100%" patternUnits="userSpaceOnUse"><rect width="100%" height="100%" fill="red"/></pattern><rect id="u7" width="11%" height="100%" x="70%" fill="url(#r7)"/><pattern id="r8-2" width="100%" height="100%" patternUnits="userSpaceOnUse"><rect width="100%" height="100%" fill="#0f0"/></pattern><pattern id="r8" width="100%" height="100%" patternUnits="userSpaceOnUse"><rect width="100%" height="100%" fill="red"/></pattern><rect id="u8" width="11%" height="100%" x="80%" fill="url(#r8)"/><rect width="11%" height="100%" fill="#0f0"/><rect width="11%" height="100%" x="90%" fill="#0f0"/><script>function startTest() { document.addEventListener(&quot;MozReftestInvalidate&quot;, doTest, false); setTimeout(doTest, 4000); // fallback for running outside reftest } function doTest() { // check that changing an id to &quot;r2&quot; lets u2 find it var r2 = document.getElementById(&quot;x&quot;); r2.setAttribute(&quot;id&quot;, &quot;r2&quot;); var rect = document.getElementById(&quot;u3&quot;).getBoundingClientRect(); // check that removing the bad r3 lets u3 find the good one var r3 = document.getElementById(&quot;r3&quot;); r3.parentNode.removeChild(r3); // check that renaming the bad r4 lets u4 find the good one var r4 = document.getElementById(&quot;r4&quot;); r4.removeAttribute(&quot;id&quot;); // check that changing u5&apos;s reference works var u5 = document.getElementById(&quot;u5&quot;); u5.setAttribute(&quot;fill&quot;, &quot;url(#r1)&quot;); // check that inserting a good element before the bad r6 works var r6 = document.getElementById(&quot;r6-2&quot;); r6.parentNode.removeChild(r6); r6.setAttribute(&quot;id&quot;, &quot;r6&quot;); document.documentElement.insertBefore(r6, document.documentElement.firstChild); // check that inserting a bad element after a good one doesn&apos;t break anything var r7 = document.getElementById(&quot;r7-2&quot;); r7.parentNode.removeChild(r7); r7.setAttribute(&quot;id&quot;, &quot;r7&quot;); document.documentElement.appendChild(r7); // check that renaming a good element to r8 works var r8 = document.getElementById(&quot;r8-2&quot;); r8.setAttribute(&quot;id&quot;, &quot;r8&quot;); document.documentElement.removeAttribute(&quot;class&quot;); }</script></svg>